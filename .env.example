# ============================================
# CONFIGURACIÓN DEL SERVIDOR
# ============================================
PORT=4000
NODE_ENV=development

# Host donde escucha el servidor (opcional, por defecto: 0.0.0.0)
# 0.0.0.0 permite conexiones desde cualquier interfaz de red (red local)
# localhost o 127.0.0.1 solo permite conexiones locales
# Para acceso desde red local, usar: 0.0.0.0
# Para solo acceso local, usar: localhost
SERVER_HOST=0.0.0.0

# URL base del servidor (sin puerto, sin barra final)
# Se usa para construir URLs completas (ej: health check)
# La URL completa se construye como: ${SERVER_BASE_URL}:${PORT}
SERVER_BASE_URL=http://localhost
# Para acceso desde red local, usar la IP de tu máquina:
# SERVER_BASE_URL=http://192.168.1.100
# O alternativamente puedes usar:
# BASE_URL=http://localhost

# ============================================
# CORS (Cross-Origin Resource Sharing)
# ============================================
# Permitir todos los orígenes (solo desarrollo, NO usar en producción)
# Si es true, se ignoran las demás configuraciones de CORS_ORIGIN
CORS_ALLOW_ALL=false

# Orígenes permitidos (uno o múltiples separados por coma)
# Si CORS_ALLOW_ALL=true, esta variable se ignora
# Ejemplos:
#   Un solo origen: CORS_ORIGIN=http://localhost:3000
#   Múltiples orígenes: CORS_ORIGIN=http://localhost:3000,https://app.midominio.com
CORS_ORIGIN=http://localhost:5174,http://localhost:4000

# Permitir credenciales (cookies, auth headers) - default: true
CORS_CREDENTIALS=true

# Métodos HTTP permitidos (separados por coma) - default: GET,POST,PUT,PATCH,DELETE,OPTIONS
CORS_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS

# Headers permitidos (separados por coma)
# Default: Content-Type,Authorization,X-Requested-With
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# Headers expuestos al cliente (separados por coma, opcional)
# Útil para exponer headers personalizados como X-Total-Count, X-Page-Count, etc.
# CORS_EXPOSED_HEADERS=X-Total-Count,X-Page-Count

# Tiempo de caché para preflight requests en segundos (default: 86400 = 24 horas)
# Reduce el número de preflight requests del navegador
CORS_MAX_AGE=86400

# ============================================
# BASE DE DATOS
# ============================================
# Habilitar MongoDB (true) o usar InMemoryDatabase (false)
# Si es false, no se requieren las variables de MongoDB
USE_MONGODB=true

# URI base de MongoDB (sin el nombre de la base de datos)
# La URI completa se construye automáticamente como: ${MONGODB_HOST}/${DATABASE_NAME}
# 
# Ejemplos:
#   Local sin autenticación: mongodb://localhost:27017
#   Con autenticación en URI: mongodb://usuario:contraseña@localhost:27017
#   Con opciones: mongodb://usuario:contraseña@localhost:27017?authSource=admin&retryWrites=true
#   Atlas: mongodb+srv://usuario:contraseña@cluster.mongodb.net
MONGODB_HOST=mongodb://localhost:27017
# O alternativamente puedes usar:
# MONGODB_URI_BASE=mongodb://localhost:27017

# Credenciales de MongoDB (opcional - se agregan automáticamente a la URI si están presentes)
# Si MONGODB_HOST no incluye credenciales, estas variables se usarán para construir la URI
# Útil cuando MongoDB está en un contenedor Docker con autenticación habilitada
# MONGODB_USER=admin
# MONGODB_PASSWORD=12345678
# MONGODB_AUTH_SOURCE=admin
# O alternativamente puedes usar:
# MONGO_USER=admin
# MONGO_PASSWORD=12345678
# MONGO_AUTH_SOURCE=admin

# Nombre de la base de datos
# Solo caracteres alfanuméricos, guiones y guiones bajos
DATABASE_NAME=gestion-expedientes-cfe

# ============================================
# LOGGING (Pino)
# ============================================
# Nivel de logging (trace, debug, info, warn, error, fatal)
LOG_LEVEL=info

# Console logging (default: true). Set to false to disable stdout logs.
LOG_TO_CONSOLE=true

# File logging (optional)
# Set LOG_TO_FILE=true to enable, and provide a path.
LOG_TO_FILE=false
LOG_FILE_PATH=./logs/app.log

# Async file writes (recommended): false keeps async. true forces sync.
# LOG_FILE_SYNC=false

# ============================================
# LOKI (Opcional - para agregación de logs)
# ============================================
# URL completa de Loki (local o remoto/Grafana Cloud)
# LOKI_URL=http://localhost:3100
# O alternativamente puedes usar:
# LOKI_HOST=http://localhost:3100

# Labels adicionales estáticas (JSON, opcional)
# Nota: Usar pocas labels estáticas (app, env, service)
# NO usar variables dinámicas como userId, orderId como labels
# LOKI_LABELS={"service":"gestion-expedientes-cfe","environment":"development"}

# Batching: agrupa logs antes de enviar (default: true)
# LOKI_BATCHING=true

# Intervalo en segundos para enviar logs (default: 5)
# LOKI_INTERVAL=5

# Autenticación básica para Loki protegido (Grafana Cloud, etc.)
# LOKI_BASIC_AUTH_USERNAME=username
# LOKI_BASIC_AUTH_PASSWORD=token_or_password

# ============================================
# EVENT BUS (En Memoria)
# ============================================
# Por ahora solo soporta 'memory'
# EVENT_BUS_TYPE=memory

# ============================================
# COLAS (En Memoria)
# ============================================
# Por ahora solo soporta 'memory'
# QUEUE_TYPE=memory

# ============================================
# AUTENTICACIÓN JWT
# ============================================
JWT_SECRET=your-super-secret-key-change-in-production
JWT_EXPIRES_IN=1h
JWT_REFRESH_SECRET=your-refresh-secret-key-change-in-production
JWT_REFRESH_EXPIRES_IN=7d

# ============================================
# RATE LIMITING (Protección contra fuerza bruta)
# ============================================
# Configuración de rate limiting para el endpoint de login
# Ventana de tiempo en milisegundos (default: 900000 = 15 minutos)
# Durante este tiempo, el usuario solo puede hacer el número máximo de intentos
RATE_LIMIT_LOGIN_WINDOW_MS=900000

# Máximo número de intentos de login por ventana de tiempo (default: 5)
# Si se excede este límite, el usuario debe esperar hasta que termine la ventana
RATE_LIMIT_LOGIN_MAX_ATTEMPTS=5

# Configuración de rate limiting para el endpoint de refresh token
# Ventana de tiempo en milisegundos (default: 900000 = 15 minutos)
RATE_LIMIT_REFRESH_WINDOW_MS=900000

# Máximo número de intentos de refresh por ventana de tiempo (default: 10)
# Generalmente más permisivo que login ya que es una operación menos crítica
RATE_LIMIT_REFRESH_MAX_ATTEMPTS=10

# ============================================
# ALMACENAMIENTO DE ARCHIVOS
# ============================================
# Directorio base para almacenar archivos subidos (default: ./uploads)
# Puede ser una ruta relativa desde la raíz del proyecto o absoluta
# En producción, se recomienda usar una ruta absoluta fuera del proyecto
# Ejemplos:
#   Relativa: ./uploads
#   Absoluta: /var/www/uploads
UPLOAD_DIR=./uploads

# Directorio específico para documentos de colaboradores (default: ./uploads/documents)
# Los documentos se organizan dentro de este directorio
# Si no se especifica, se usa: ${UPLOAD_DIR}/documents
DOCUMENTS_DIR=./uploads/documents

# Directorio específico para minutas (default: ./uploads/minutes)
# Las minutas se organizan dentro de este directorio
# Si no se especifica, se usa: ${UPLOAD_DIR}/minutes
MINUTES_DIR=./uploads/minutes

# Tamaño máximo de archivo en bytes (default: 10485760 = 10MB)
# Ejemplos:
#   10MB: 10485760
#   20MB: 20971520
#   50MB: 52428800
MAX_FILE_SIZE=10485760

# Tipos MIME permitidos (separados por coma)
# Estos son los tipos de archivo que se pueden subir al sistema
# Default: PDF, DOC, DOCX, XLS, XLSX, imágenes (JPEG, PNG)
# Ejemplos de tipos MIME comunes:
#   PDF: application/pdf
#   Word: application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document
#   Excel: application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
#   Imágenes: image/jpeg, image/png, image/jpg
ALLOWED_FILE_TYPES=application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,image/jpeg,image/png,image/jpg
